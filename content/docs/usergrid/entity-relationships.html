<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="Easemob - 即时通讯云-五分钟为你的APP加入聊天功能。" name="description">
    <meta content="Easemob" name="author">
    <title>Entity relationships | Easemob</title>
    <link href="http://cdn.bootcss.com/twitter-bootstrap/3.0.3/css/bootstrap.min.css" rel="stylesheet">
    <link href="/assets/css/docs.css" rel="stylesheet">
    <link href="http://cdn.bootcss.com/highlight.js/7.3/styles/github.min.css" rel="stylesheet">
    <style type="text/css">
      body{font-family:"ff-tisa-web-pro-1","ff-tisa-web-pro-2","Lucida Grande","Helvetica Neue",Helvetica,Arial,"Hiragino Sans GB","Hiragino Sans GB W3","WenQuanYi Micro Hei",sans-serif;}
      h1, .h1, h2, .h2, h3, .h3, h4, .h4, .lead {font-family:"ff-tisa-web-pro-1","ff-tisa-web-pro-2","Lucida Grande","Helvetica Neue",Helvetica,Arial,"Hiragino Sans GB","Hiragino Sans GB W3","Microsoft YaHei UI","Microsoft YaHei","WenQuanYi Micro Hei",sans-serif;}
      pre code { background: transparent; }
      @media (min-width: 768px) {
          .bs-docs-home .bs-social,
          .bs-docs-home .bs-masthead-links {
            margin-left: 0;
          }
      }
    </style>
    <!--[if lt IE 9]
    script  type='text/javascript' src=("/assets/js/ie8-responsive-file-warning.js" ) 
    script  type='text/javascript' src=("http://cdn.bootcss.com/html5shiv/3.7.0/html5shiv.min.js" ) 
    script  type='text/javascript' src=("http://cdn.bootcss.com/respond.js/1.3.0/respond.min.js" ) -->
    <link href="/assets/ico/apple-touch-icon-144-precomposed.png" rel="apple-touch-icon-precomposed" sizes="144x144">
    <link href="/assets/ico/favicon.ico" rel="shortcut icon">
  </head>
  <body><div id="content" class="bs-header">
  <div class="container">
    <h1>
      Entity relationships
    </h1>
    <p>
      Easemob
    </p>
  </div>
</div>
<div class="container bs-docs-container">
  <div class="row">
    <div class="col-md-12" role="main">
<h1 id="entity-relationships">Entity relationships</h1>

<h2 id="creating-connections-between-entities">Creating connections between entities</h2>

<p>One of the most useful features of App services is the ability to create
connections between entities. A simple example of this is the
Twitter-like use of <em>following</em>, where one user forms a connection with
another by subscribing to any tweets they post. <a href="/messagee-example">Messagee
Example</a> walks you through an example of following
other users in our sample app, <em>Messagee</em>. Here is the basic format:</p>

<pre><code>POST https://api.usergrid.com/my-org/my-app/users/fred/following/users/barney
</code></pre>

<p>This API call results in two users, Fred and Barney, linked with a
connection where Fred is following Barney.</p>

<p>If you create a <em>following</em> connection between two users, Apache Usergrid
automatically creates a virtual connection called <em>followers</em> that
mirrors the <em>following</em> connection. In other words, if you create a
connection where Fred is following Barney, Apache Usergrid automatically
creates a virtual connection where Fred is a follower of Barney.</p>

<p>Note that there is no mirror connection established. Apache Usergrid only
creates a mirror connection when you create a <em>following</em> connection. It
does not create a mirror connection for other verbs such as likes.</p>

<p>You can see all the users that Fred is following, in this case only
Barney, by making the following API call:</p>

<pre><code>GET https://api.usergrid.com/my-org/my-app/users/fred/following
</code></pre>

<p>You can see all of barney’s followers, in this case only Fred, by making
the following API call:</p>

<pre><code>GET https://api.usergrid.com/my-org/my-app/users/barney/followers
</code></pre>

<p>The <em>followers</em> connection is a virtual connection because you can’t use
it to link two entities. In other words, you can’t make fred a follower
of barney by using a <em>followers</em> connection.  <strong>This is wrong:</strong></p>

<pre><code>POST https://api.usergrid.com/my-org/my-app/users/barney/followers/users/fred
</code></pre>

<p>To create a <em>following</em> connection with the users switched, so that
Barney is following Fred, do this:</p>

<pre><code>POST https://api.usergrid.com/my-org/my-app/users/barney/following/users/fred
</code></pre>

<p>You can now see Fred’s followers (only Barney) by making the following
call:</p>

<pre><code>GET https://api.usergrid.com/my-org/my-app/users/fred/followers
</code></pre>

<h2 id="creating-other-connections">Creating other connections</h2>

<p>You can extend this connection structure to create connections using any
"verb" that can link two entities. For example, you could use likes to
denote a connection between a user and his dog. First, create a dogs
collection:</p>

<pre><code>POST https://api.usergrid.com/my-org/my-app/dogs
</code></pre>

<p>Then populate this collection with a new dog named Dino:</p>

<pre><code>POST https://api.usergrid.com/my-org/my-app/dogs {"name" : "dino"}
</code></pre>

<p>Then create a likes connection between Fred and his dog Dino:</p>

<pre><code>POST https://api.usergrid.com/my-org/my-app/users/fred/likes/dogs/dino
</code></pre>

<h2 id="getting-connections">Getting connections</h2>

<h3 id="get-all-connections-for-an-entity">Get all connections for an entity</h3>

<p>To get a list that only contains the connections, do a GET on the
connections sub-property of the entity:</p>

<pre><code>GET https://api.usergrid.com/my-org/my-app/users/fred/connections
</code></pre>

<h3 id="get-information-on-a-specific-connection-type">Get information on a specific connection type</h3>

<p>To get a list of users who like Fred:</p>

<pre><code>GET https://api.usergrid.com/my-org/my-app/users/fred/connecting/likes
</code></pre>

<p>To get a list of all dogs that Fred likes:</p>

<pre><code>GET https://api.usergrid.com/my-org/my-app/users/fred/likes/dog
</code></pre>

<h2 id="deleting-a-connection">Deleting a connection</h2>

<p>You can delete a connection in a way similar to creating one. Just
replace the POST method with the DELETE method. For example, you can
delete the connection between fred and barney with the following API
call:</p>

<pre><code>DELETE https://api.usergrid.com/my-org/my-app/users/fred/following/barney
</code></pre>

    </div>
  </div>
</div><footer class="bs-footer" role="contentinfo">
      <div class="container">
        <p class="text-muted">
          环信即时通讯云
        </p>
      </div>
    </footer>
    <script src="http://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>
    <script src="http://cdn.bootcss.com/twitter-bootstrap/3.0.3/js/bootstrap.min.js"></script>
    <script src="http://cdn.bootcss.com/holder/2.0/holder.min.js"></script>
    <script src="http://cdn.bootcss.com/highlight.js/7.3/highlight.min.js"></script>
    <script type="text/javascript">
      hljs.initHighlightingOnLoad();
      var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
      document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F3e5b3453fdcff1e4dec124ea22f1e189' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script src="/assets/js/application.js"></script>
  </body>
</html>