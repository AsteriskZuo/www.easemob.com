<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="Easemob - 即时通讯云-五分钟为你的APP加入聊天功能。" name="description">
    <meta content="Easemob" name="author">
    <title>Deleting Collections | Easemob</title>
    <link href="http://cdn.bootcss.com/twitter-bootstrap/3.0.3/css/bootstrap.min.css" rel="stylesheet">
    <link href="/assets/css/docs.css" rel="stylesheet">
    <link href="http://cdn.bootcss.com/highlight.js/7.3/styles/github.min.css" rel="stylesheet">
    <style type="text/css">
      body{font-family:"ff-tisa-web-pro-1","ff-tisa-web-pro-2","Lucida Grande","Helvetica Neue",Helvetica,Arial,"Hiragino Sans GB","Hiragino Sans GB W3","WenQuanYi Micro Hei",sans-serif;}
      h1, .h1, h2, .h2, h3, .h3, h4, .h4, .lead {font-family:"ff-tisa-web-pro-1","ff-tisa-web-pro-2","Lucida Grande","Helvetica Neue",Helvetica,Arial,"Hiragino Sans GB","Hiragino Sans GB W3","Microsoft YaHei UI","Microsoft YaHei","WenQuanYi Micro Hei",sans-serif;}
      pre code { background: transparent; }
      @media (min-width: 768px) {
          .bs-docs-home .bs-social,
          .bs-docs-home .bs-masthead-links {
            margin-left: 0;
          }
      }
    </style>
    <!--[if lt IE 9]
    script  type='text/javascript' src=("/assets/js/ie8-responsive-file-warning.js" ) 
    script  type='text/javascript' src=("http://cdn.bootcss.com/html5shiv/3.7.0/html5shiv.min.js" ) 
    script  type='text/javascript' src=("http://cdn.bootcss.com/respond.js/1.3.0/respond.min.js" ) -->
    <link href="/assets/ico/apple-touch-icon-144-precomposed.png" rel="apple-touch-icon-precomposed" sizes="144x144">
    <link href="/assets/ico/favicon.ico" rel="shortcut icon">
  </head>
  <body><div id="content" class="bs-header">
  <div class="container">
    <h1>
      Deleting Collections
    </h1>
    <p>
      Easemob
    </p>
  </div>
</div>
<div class="container bs-docs-container">
  <div class="row">
    <div class="col-md-12" role="main">
<h1 id="deleting-collections">Deleting Collections</h1>

<p>This article describes how to batch delete entities in a collection.
Batch deletes require the use of a query string in the request, which
can either specify all entities in the collection or a subset of
entities to be deleted. For more information on queries, see <a href="/basic-query-syntax">Basic
query syntax</a>. Currently, collections cannot be
deleted in Apache Usergrid.</p>

<p><strong>Note:</strong> Although not shown in the API examples below, you need to
provide a valid access token with each API call. See <a href="/authenticating-users-and-application-clients">Authenticating
users and application
clients</a> for details.</p>

<h2 id="batch-deleting-entities-in-a-collection">Batch deleting entities in a collection</h2>

<ul>
  <li><a href="#curl_delete_collection">cURL</a></li>
  <li><a href="#ios_delete_collection">iOS</a></li>
  <li><a href="#android_delete_collection">Android</a></li>
  <li><a href="#javascript_delete_collection">JavaScript (HTML5)</a></li>
  <li><a href="#ruby_delete_collection">Ruby</a></li>
  <li><a href="#nodejs_delete_collection">Node.js</a></li>
</ul>

<h3 id="example-requestresponse">Example Request/Response</h3>

<h4 id="request">Request:</h4>

<pre><code>curl -X DELETE "https://api.usergrid.com/your-org/your-app/items/"
</code></pre>

<h4 id="response">Response:</h4>

<pre><code>{
  "action" : "delete",
  "application" : "f34f4222-a166-11e2-a7f7-02e81adcf3d0",
  "params" : {
    "ql" : [ "" ]
  },
  "path" : "/items",
  "uri" : "http://api.usergrid.com/your-org/your-app/items",
  "entities" : [ {
    "uuid" : "53fe3700-0abe-11e3-b1f7-1bd100b8059e",
    "type" : "item",
    "name" : "milk",
    "price" : "3.25",
    "created" : 1377129832047,
    "modified" : 1377129832047,
    "metadata" : {
      "path" : "/items/53fe3700-0abe-11e3-b1f7-1bd100b8059e"
    },
    "name" : "milk"
  }, {
    "uuid" : "5ae1fa7a-0abe-11e3-89ab-6be0003c809b",
    "type" : "item",
    "name" : "bread",
    "price" : "4.00",
    "created" : 1377129843607,
    "modified" : 1377129843607,
    "metadata" : {
      "path" : "/items/5ae1fa7a-0abe-11e3-89ab-6be0003c809b"
    },
    "name" : "bread"
  } ],
  "timestamp" : 1378848117272,
  "duration" : 12275,
  "organization" : "your-org",
  "applicationName" : "your-app"
}
</code></pre>

<h3 id="request-syntax">Request Syntax</h3>

<pre><code>curl -X DELETE https://api.usergrid.com/&lt;org&gt;/&lt;app&gt;/&lt;collection&gt;/?ql=
</code></pre>

<p>Note that you must include an empty query string (?ql=) at the end of
the URL</p>

<h3 id="parameters">Parameters</h3>

<p>Parameter    Description
  ———— —————————————-
  org          Organization UUID or organization name
  app          Application UUID or application name
  collection   Collection UUID or collection name</p>

<p>This example uses the <a href="/app-services-sdks#ios">Apache Usergrid iOS SDK</a>.</p>

<h3 id="example-requestresponse-1">Example Request/Response</h3>

<h4 id="request-1">Request:</h4>

<pre><code>-(NSString*)deleteCollection {

    NSString *url = @"https://api.usergrid.com/your-org/your-app/items/?ql";
    NSString *op = @"DELETE";
    NSString *opData = nil;
    
    //we recommend you call ApigeeClient from your AppDelegate. 
    //for more information see the iOS SDK install guide: http://apigee.com/docs/app-services/content/installing-apigee-sdk-ios
    //create an instance of AppDelegate
    AppDelegate *appDelegate = (AppDelegate *)[[UIApplication sharedApplication] delegate];
    
    //call createEntity to initiate the API call
    ApigeeClientResponse *response = [appDelegate.dataClient apiRequest: url operation: op data: opData];
    
    @try {
        //success
    }
    @catch (NSException * e) {
        //fail
    }

}
</code></pre>

<h4 id="response-1">Response:</h4>

<pre><code>{
  "action" : "delete",
  "application" : "f34f4222-a166-11e2-a7f7-02e81adcf3d0",
  "params" : {
    "ql" : [ "" ]
  },
  "path" : "/items",
  "uri" : "http://api.usergrid.com/your-org/your-app/items",
  "entities" : [ {
    "uuid" : "53fe3700-0abe-11e3-b1f7-1bd100b8059e",
    "type" : "item",
    "name" : "milk",
    "price" : "3.25",
    "created" : 1377129832047,
    "modified" : 1377129832047,
    "metadata" : {
      "path" : "/items/53fe3700-0abe-11e3-b1f7-1bd100b8059e"
    },
    "name" : "milk"
  }, {
    "uuid" : "5ae1fa7a-0abe-11e3-89ab-6be0003c809b",
    "type" : "item",
    "name" : "bread",
    "price" : "4.00",
    "created" : 1377129843607,
    "modified" : 1377129843607,
    "metadata" : {
      "path" : "/items/5ae1fa7a-0abe-11e3-89ab-6be0003c809b"
    },
    "name" : "bread"
  } ],
  "timestamp" : 1378848117272,
  "duration" : 12275,
  "organization" : "your-org",
  "applicationName" : "your-app"
}
</code></pre>

<h3 id="sdk-method">SDK Method</h3>

<pre><code>(ApigeeClientResponse *)apiRequest: (NSString *)url operation:(NSString *)op data:(NSString *)opData
</code></pre>

<h3 id="properties">Properties</h3>

<p>+————————————–+————————————–+
| Parameter                            | Description                          |
+======================================+======================================+
| url                                  | A fully-formed url in the following  |
|                                      | format:                              |
|                                      |     https://api.usergrid.com/<org>/&lt; |
|                                      | app&gt;/<collection>/?ql=               |
|                                      |                                      |
|                                      | Note that you must include an empty  |
|                                      | '?ql=' query string at the end of    |
|                                      | the URL                              |
+--------------------------------------+--------------------------------------+
| op                                   | The HTTP method - in this case,      |
|                                      | 'DELETE'                             |
+--------------------------------------+--------------------------------------+
| opData                               | No data is being sent, so the value  |
|                                      | is `nil`                             |
+--------------------------------------+--------------------------------------+</collection></org></p>

<p>Currently, deleting all entities in a collection is not supported by the
<a href="/app-services-sdks#android">Apache Usergrid SDK for Android</a>.</p>

<p>This example uses the <a href="/app-services-sdks#javascript">Apache Usergrid JavaScript (HTML5)
SDK</a>.</p>

<h3 id="example-requestresponse-2">Example Request/Response</h3>

<h4 id="request-2">Request:</h4>

<pre><code>//create the basic client object
var dataClient = new Usergrid.Client({
    org_name:'your-org',
    app_name:'your-app'
});

//options for the request
var options = {
    endpoint:"items/?ql=", //don't forget to append '/?ql='
    method:"DELETE",
}

dataClient.request(options,function (error,response) {

    if (error) { 
        // Error
    } else { 
        // Success
    }

});    
</code></pre>

<h4 id="response-2">Response:</h4>

<p>The API will respond with 404 Resource Not Found.</p>

<h3 id="sdk-method-1">SDK Method</h3>

<pre><code>request(options, callback)
</code></pre>

<h3 id="parameters-1">Parameters</h3>

<p>+————————————–+————————————–+
| Parameter                            | Description                          |
+======================================+======================================+
| options                              | A JSON-formatted object containing   |
|                                      | the following properties:            |
|                                      |                                      |
|                                      | -   endpoint: the UUID or name of    |
|                                      |     the collection to be emptied,    |
|                                      |     appended by an empty query       |
|                                      |     string in the format:            |
|                                      |     &lt;collection&gt;/?ql=              |
|                                      | -   method: the HTTP method for the  |
|                                      |     request, in this case <em>DELETE</em>   |
+————————————–+————————————–+
| callback                             | Callback function to handle the API  |
|                                      | response                             |
+————————————–+————————————–+</p>

<h3 id="example-requestresponse-3">Example Request/Response</h3>

<h4 id="request-3">Request:</h4>

<pre><code>#Create a client object
usergrid_api = 'https://api.usergrid.com'
organization = 'your-org'
application = 'your-app'

client = Usergrid::Application.new "#{usergrid_api}/#{organization}/#{application}"

begin
    client['item'].delete_query ""
rescue
    #fail
end
</code></pre>

<h4 id="response-3">Response:</h4>

<pre><code>{
  "action" : "delete",
  "application" : "f34f4222-a166-11e2-a7f7-02e81adcf3d0",
  "params" : {
    "ql" : [ "" ]
  },
  "path" : "/items",
  "uri" : "http://api.usergrid.com/your-org/your-app/items",
  "entities" : [ {
    "uuid" : "53fe3700-0abe-11e3-b1f7-1bd100b8059e",
    "type" : "item",
    "name" : "milk",
    "price" : "3.25",
    "created" : 1377129832047,
    "modified" : 1377129832047,
    "metadata" : {
      "path" : "/items/53fe3700-0abe-11e3-b1f7-1bd100b8059e"
    },
    "name" : "milk"
  }, {
    "uuid" : "5ae1fa7a-0abe-11e3-89ab-6be0003c809b",
    "type" : "item",
    "name" : "bread",
    "price" : "4.00",
    "created" : 1377129843607,
    "modified" : 1377129843607,
    "metadata" : {
      "path" : "/items/5ae1fa7a-0abe-11e3-89ab-6be0003c809b"
    },
    "name" : "bread"
  } ],
  "timestamp" : 1378848117272,
  "duration" : 12275,
  "organization" : "your-org",
  "applicationName" : "your-app"
}
</code></pre>

<h3 id="sdk-method-2">SDK Method</h3>

<pre><code>delete_query &lt;query_string&gt;
</code></pre>

<h3 id="properties-1">Properties</h3>

<p>Parameter       Description
  ————— ——————————————————————————————————————————–
  query_string   A query string that specifies the entities to be deleted. Use an empty string (<code>""</code>) to delete all entities in the collection.</p>

<p>This example uses the <a href="/app-services-sdks#nodejs">Apache Usergrid Node.js
module</a>.</p>

<h3 id="example-requestresponse-4">Example Request/Response</h3>

<h4 id="request-4">Request:</h4>

<pre><code>//create the basic client object
var dataClient = new Usergrid.client({
    org_name:'your-org',
    app_name:'your-app'
});

//options for the request
var options = {
    endpoint:"items/?ql=", //don't forget to append '/?ql='
    method:"DELETE"
}

dataClient.request(options,function (error,response) {

    if (error) { 
        // Error
    } else { 
        // Success
    }

});     
</code></pre>

<h4 id="response-4">Response:</h4>

<pre><code>{ action: 'delete',
  application: 'f34f4222-a166-11e2-a7f7-02e81adcf3d0',
  params: { ql: [ '' ] },
  path: '/tests',
  uri: 'http://api.usergrid.com/your-org/your-app/items',
  entities: 
   [ { uuid: '5eac800a-1a61-11e3-95b8-4f685c4bb3d6',
       type: 'item',
       name: 'milk',
       price: '3.25',
       created: 1378849125376,
       modified: 1378849125376,
       metadata: [Object] },
     { uuid: '5eb77c8a-1a61-11e3-aae6-3be70698d378',
       type: 'item',
       name: 'bread',
       price: '4.00',
       created: 1378849125448,
       modified: 1378849125448,
       metadata: [Object] } ],
  timestamp: 1378849137959,
  duration: 648,
  organization: 'your-org',
  applicationName: 'your-app' }
</code></pre>

<h3 id="sdk-method-3">SDK Method</h3>

<pre><code>entity.destroy()
</code></pre>

<h3 id="parameters-2">Parameters</h3>

<p>Parameter   Description
  ———– ———————————————-
  callback    Callback function to handle the API response</p>

<p> </p>

    </div>
  </div>
</div><footer class="bs-footer" role="contentinfo">
      <div class="container">
        <p class="text-muted">
          环信即时通讯云
        </p>
      </div>
    </footer>
    <script src="http://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>
    <script src="http://cdn.bootcss.com/twitter-bootstrap/3.0.3/js/bootstrap.min.js"></script>
    <script src="http://cdn.bootcss.com/holder/2.0/holder.min.js"></script>
    <script src="http://cdn.bootcss.com/highlight.js/7.3/highlight.min.js"></script>
    <script type="text/javascript">
      hljs.initHighlightingOnLoad();
      var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
      document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F3e5b3453fdcff1e4dec124ea22f1e189' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script src="/assets/js/application.js"></script>
  </body>
</html>