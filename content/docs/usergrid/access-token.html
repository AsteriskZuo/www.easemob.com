<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="Easemob - 即时通讯云-五分钟为你的APP加入聊天功能。" name="description">
    <meta content="Easemob" name="author">
    <title>Access token | Easemob</title>
    <link href="http://cdn.bootcss.com/twitter-bootstrap/3.0.3/css/bootstrap.min.css" rel="stylesheet">
    <link href="/assets/css/docs.css" rel="stylesheet">
    <link href="http://cdn.bootcss.com/highlight.js/7.3/styles/github.min.css" rel="stylesheet">
    <style type="text/css">
      body{font-family:"ff-tisa-web-pro-1","ff-tisa-web-pro-2","Lucida Grande","Helvetica Neue",Helvetica,Arial,"Hiragino Sans GB","Hiragino Sans GB W3","WenQuanYi Micro Hei",sans-serif;}
      h1, .h1, h2, .h2, h3, .h3, h4, .h4, .lead {font-family:"ff-tisa-web-pro-1","ff-tisa-web-pro-2","Lucida Grande","Helvetica Neue",Helvetica,Arial,"Hiragino Sans GB","Hiragino Sans GB W3","Microsoft YaHei UI","Microsoft YaHei","WenQuanYi Micro Hei",sans-serif;}
      pre code { background: transparent; }
      @media (min-width: 768px) {
          .bs-docs-home .bs-social,
          .bs-docs-home .bs-masthead-links {
            margin-left: 0;
          }
      }
    </style>
    <!--[if lt IE 9]
    script  type='text/javascript' src=("/assets/js/ie8-responsive-file-warning.js" ) 
    script  type='text/javascript' src=("http://cdn.bootcss.com/html5shiv/3.7.0/html5shiv.min.js" ) 
    script  type='text/javascript' src=("http://cdn.bootcss.com/respond.js/1.3.0/respond.min.js" ) -->
    <link href="/assets/ico/apple-touch-icon-144-precomposed.png" rel="apple-touch-icon-precomposed" sizes="144x144">
    <link href="/assets/ico/favicon.ico" rel="shortcut icon">
  </head>
  <body><div id="content" class="bs-header">
  <div class="container">
    <h1>
      Access token
    </h1>
    <p>
      Easemob
    </p>
  </div>
</div>
<div class="container bs-docs-container">
  <div class="row">
    <div class="col-md-12" role="main">
<h1 id="access-token">Access token</h1>

<p><a href="/docs/usergrid/content/management-resources">See all management
resources</a><a href="/docs/usergrid/content/management-resources"><img src="/docs/sites/docs/files/learnmore%20arrow_0.png" alt="" /></a></p>

<p>An access token carries the credentials and authorization information
needed to access other resources through the Apache Usergrid API. Using the
API, you can obtain an access token.</p>

<h2 id="requesting-an-access-token">Requesting an access token</h2>

<p>Use the POST method to obtain an access token.</p>

<h3 id="request-uri">Request URI</h3>

<p>The request URL depends on the access type:</p>

<p>Access Type        Request URL
  —————— —————————————————————————————————————————————————————————————-
  Application user   POST /&lt;org_id&gt;/&lt;app_id&gt;/token '{"grant_type":"password", "username":"&lt;username&gt;", "password":"&lt;password&gt;"[, "ttl":"&lt;token_time_to_live&gt;"]}'
  Application        POST /&lt;org_id&gt;/&lt;app_id&gt;/token '{"grant_type":"client_credentials", "client_id":"&lt;client_id&gt;", "client_secret":"&lt;client_secret&gt;"[, "ttl":"&lt;token_time_to_live&gt;"]}'
  Admin User         POST /token '{"grant_type":"password", "username":"&lt;username&gt;", "password":"&lt;password&gt;"[, "ttl":"&lt;token_time_to_live&gt;"]}'
  Organization       POST /token '{"grant_type":"client_credentials", "client_id":"&lt;client_id&gt;", "client_secret":"&lt;client_secret&gt;"}'</p>

<p>See <a href="/authenticating-users-and-application-clients">Authenticating users and application
clients</a> for further
details about access types.</p>

<h3 id="parameters">Parameters</h3>

<p>Parameter Name   Type     Description
  —————- ——– —————————————————————————————————————————————————————————————————————————————
  client_id       string   Organization client ID. You can find this in the admin portal.
  client_secret   string   Organization client secret. You can find this in the admin portal
  username         string   Value of the User entity username property. 
  password         string   Password stored for this user.
  ttl              long     <em>Optional.</em> The amount of time, in miliseconds, that this token will be valid before authentication is required again. This must be less than the accesstokenttl property of the application entity the token is being requested for.</p>

<p> </p>

<h3 id="example---request-application-user">Example - Request (Application user)</h3>

<ul>
  <li><a href="#curl_get_token_appuser">cURL</a></li>
  <li><a href="#javascript_get_token_appuser">JavaScript (HTML5)</a></li>
  <li><a href="#ruby_get_token_appuser">Ruby</a></li>
  <li><a href="#nodejs_get_token_appuser">Node.js</a></li>
</ul>

<!-- -->

<pre><code>curl -X POST -i -H "Content-Type: application/json" “https://api.usergrid.com/&lt;org_name&gt;/&lt;app_name&gt;/token”  -d '{"grant_type":"password","username":"testadmin","password":"testadminpw"}'
</code></pre>

<p>The example assumes use of the <a href="https://github.com/apigee/usergrid-javascript-sdk">JavaScript (HTML5)
SDK</a>.</p>

<pre><code>var username = 'testuser';
var password = 'testpasswd';
client.login(username, password,
    function (err) {
        if (err) {
            //error — could not log user in
        } else {
            //success — user has been logged in
            var token = client.token;
        }
    }
);
</code></pre>

<p>The example assumes use of the <a href="https://github.com/scottganyo/usergrid_iron">Ruby
SDK</a>.</p>

<pre><code>app = Usergrid::Application.new 'https://api.usergrid.com/my-org/my-app/'
app.login 'testuser', 'testpasswd'
token = app.auth_token
</code></pre>

<p>The example assumes use of the <a href="https://github.com/apigee/usergrid-node-module">Node.js
module</a>.</p>

<pre><code>var username = 'testuser';
var password = 'testpasswd';
client.login(username, password,
    function (err) {
        if (err) {
            //error — could not log user in
        } else {
            //success — user has been logged in
            var token = client.token;
        }
    }
);
</code></pre>

<h3 id="example---response">Example - Response</h3>

<pre><code>{
  "access_token": "5wuGd-lcEeCUBwBQVsAACA:F8zeMOlcEeCUBwBQVsAACA:YXU6AAABMq0hdy4Lh0ewmmnOWOR-DaepCrpWx9oPmw",
  "expires_in": 3600,
  "user": {
    "uuid": "e70b8677-e95c-11e0-9407-005056c00008",
    "type": "user",
    "username": "testuser",
    "email": "testuser@mail.com",
    "activated": true,
    "created": 1317164604367013,
    "modified": 1317164604367013
  }
</code></pre>

<h3 id="example---request-admin-user">Example - Request (Admin user)</h3>

<ul>
  <li><a href="#curl_get_token_adminuser">cURL</a></li>
  <li><a href="#javascript_get_token_adminuser">JavaScript (HTML5)</a></li>
  <li><a href="#ruby_get_token_adminuser">Ruby</a></li>
  <li><a href="#nodejs_get_token_adminuser">Node.js</a></li>
</ul>

<!-- -->

<pre><code>curl -X POST -i -H "Content-Type: application/json" “https://api.usergrid.com/management/token”  -d '{"grant_type":"password","username":"testadmin","password":"testadminpw"}'
</code></pre>

<p>It is recommended that you use the <a href="http://apigee.com/usergrid">Admin
Portal</a> for administrative activities
instead of using JavaScript to do them programmatically in your app.</p>

<p><strong>Note:</strong>You can see the response below in the Admin Portal by using the
<a href="/docs/usergrid/content/displaying-app-services-api-calls-curl-commands">JavaScript
Console</a>.</p>

<p>The example assumes use of the <a href="https://github.com/scottganyo/usergrid_iron">Ruby
SDK</a>.</p>

<pre><code>mgmt = Usergrid::Management.new 'https://api.usergrid.com/'
mgmt.login test, testpass
token = mgmt.auth_token
</code></pre>

<p>The example assumes use of the <a href="https://github.com/apigee/usergrid-node-module">Node.js
module</a>.</p>

<pre><code>var username = 'testuser';
var password = 'testpasswd';
client.login(username, password,
    function (err) {
        if (err) {
            //error — could not log admin user in
        } else {
            //success — admin user has been logged in
            var token = client.token;
        }
    }
);
</code></pre>

<h3 id="example---response-1">Example - Response</h3>

<pre><code>{
  "access_token": "f_GUbelXEeCfRgBQVsAACA:YWQ6AAABMqz_xUyYeErOkKjnzN7YQXXlpgmL69fvaA",
  "expires_in": 3600,
  "user": {
    "username": "test",
    "email": "test@usergrid.com",
    "organizations": {
      "test-organization": {
        "users": {
          "test": {
            "name": "Test User",
            "disabled": false,
            "uuid": "7ff1946d-e957-11e0-9f46-005056c00008",
            "activated": true,
            "username": "test",
            "applicationId": "00000000-0000-0000-0000-000000000001",
            "email": "test@usergrid.com",
            "adminUser": true,
            "mailTo": "Test User "
          }
        },
        "name": "test-organization",
        "applications": {
          "test-app": "8041893b-e957-11e0-9f46-005056c00008"
        },
        "uuid": "800b8510-e957-11e0-9f46-005056c00008"
      }
    },
    "adminUser": true,
    "activated": true,
    "name": "Test User",
    "mailTo": "Test User ",
    "applicationId": "00000000-0000-0000-0000-000000000001",
    "uuid": "7ff1946d-e957-11e0-9f46-005056c00008",
    "disabled": false
  }
}
</code></pre>

    </div>
  </div>
</div><footer class="bs-footer" role="contentinfo">
      <div class="container">
        <p class="text-muted">
          环信即时通讯云
        </p>
      </div>
    </footer>
    <script src="http://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>
    <script src="http://cdn.bootcss.com/twitter-bootstrap/3.0.3/js/bootstrap.min.js"></script>
    <script src="http://cdn.bootcss.com/holder/2.0/holder.min.js"></script>
    <script src="http://cdn.bootcss.com/highlight.js/7.3/highlight.min.js"></script>
    <script type="text/javascript">
      hljs.initHighlightingOnLoad();
      var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
      document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F3e5b3453fdcff1e4dec124ea22f1e189' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script src="/assets/js/application.js"></script>
  </body>
</html>