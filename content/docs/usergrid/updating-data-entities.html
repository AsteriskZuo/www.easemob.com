<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="Easemob - 即时通讯云-五分钟为你的APP加入聊天功能。" name="description">
    <meta content="Easemob" name="author">
    <title>Updating Data Entities | Easemob</title>
    <link href="http://cdn.bootcss.com/twitter-bootstrap/3.0.3/css/bootstrap.min.css" rel="stylesheet">
    <link href="/assets/css/docs.css" rel="stylesheet">
    <link href="http://cdn.bootcss.com/highlight.js/7.3/styles/github.min.css" rel="stylesheet">
    <style type="text/css">
      body{font-family:"ff-tisa-web-pro-1","ff-tisa-web-pro-2","Lucida Grande","Helvetica Neue",Helvetica,Arial,"Hiragino Sans GB","Hiragino Sans GB W3","WenQuanYi Micro Hei",sans-serif;}
      h1, .h1, h2, .h2, h3, .h3, h4, .h4, .lead {font-family:"ff-tisa-web-pro-1","ff-tisa-web-pro-2","Lucida Grande","Helvetica Neue",Helvetica,Arial,"Hiragino Sans GB","Hiragino Sans GB W3","Microsoft YaHei UI","Microsoft YaHei","WenQuanYi Micro Hei",sans-serif;}
      pre code { background: transparent; }
      @media (min-width: 768px) {
          .bs-docs-home .bs-social,
          .bs-docs-home .bs-masthead-links {
            margin-left: 0;
          }
      }
    </style>
    <!--[if lt IE 9]
    script  type='text/javascript' src=("/assets/js/ie8-responsive-file-warning.js" ) 
    script  type='text/javascript' src=("http://cdn.bootcss.com/html5shiv/3.7.0/html5shiv.min.js" ) 
    script  type='text/javascript' src=("http://cdn.bootcss.com/respond.js/1.3.0/respond.min.js" ) -->
    <link href="/assets/ico/apple-touch-icon-144-precomposed.png" rel="apple-touch-icon-precomposed" sizes="144x144">
    <link href="/assets/ico/favicon.ico" rel="shortcut icon">
  </head>
  <body><div id="content" class="bs-header">
  <div class="container">
    <h1>
      Updating Data Entities
    </h1>
    <p>
      Easemob
    </p>
  </div>
</div>
<div class="container bs-docs-container">
  <div class="row">
    <div class="col-md-12" role="main">
<h1 id="updating-data-entities">Updating Data Entities</h1>

<p>This article describes how to update entities in your Apache Usergrid
account.</p>

<p><strong>Note:</strong> Although not shown in the API examples below, you need to
provide a valid access token with each API call. See <a href="/authenticating-users-and-application-clients">Authenticating
users and application
clients</a> for details.</p>

<h2 id="updating-an-entity">Updating an entity</h2>

<p>One or more properties can be updated with a single PUT request. For
information on updating sub-properties, see <a href="#update_nested">Updating
sub-properties</a> below.</p>

<ul>
  <li><a href="#curl_update_entity">cURL</a></li>
  <li><a href="#ios_update_entity">iOS</a></li>
  <li><a href="#android_update_entity">Android</a></li>
  <li><a href="#javascript_update_entity">JavaScript (HTML5)</a></li>
  <li><a href="#ruby_update_entity">Ruby</a></li>
  <li><a href="#nodejs_update_entity">Node.js</a></li>
</ul>

<h3 id="example-requestresponse">Example Request/Response</h3>

<h4 id="request">Request:</h4>

<pre><code>curl -X PUT https://api.usergrid.com/your-org/your-app/items/milk -d '{"price":"4.00", "availability":"in-stock"}'
</code></pre>

<h4 id="response">Response:</h4>

<pre><code>{
  "action" : "put",
  "application" : "f34f4222-a166-11e2-a7f7-02e81adcf3d0",
  "params" : { },
  "path" : "/items",
  "uri" : "http://api.usergrid.com/your-org/your-app/items",
  "entities" : [ {
    "uuid" : "5bb76bca-1657-11e3-903f-9ff6c621a7a4",
    "type" : "item",
    "name" : "milk",
    "created" : 1378405020796,
    "modified" : 1378505705077,
    "availability" : "in-stock",
    "metadata" : {
      "path" : "/items/5bb76bca-1657-11e3-903f-9ff6c621a7a4"
    },
    "name" : "milk",
    "price" : "4.00"
  } ],
  "timestamp" : 1378505705050,
  "duration" : 87,
  "organization" : "your-org",
  "applicationName" : "your-app"
}
</code></pre>

<h3 id="request-syntax">Request Syntax</h3>

<pre><code>curl -X PUT https://api.usergrid.com/&lt;org&gt;/&lt;app&gt;/&lt;collection&gt;/&lt;entity&gt; -d {&lt;property&gt;}
</code></pre>

<h3 id="parameters">Parameters</h3>

<p>+————————————–+————————————–+
| Parameter                            | Description                          |
+======================================+======================================+
| org                                  | Organization UUID or organization    |
|                                      | name                                 |
+————————————–+————————————–+
| app                                  | Application UUID or application name |
+————————————–+————————————–+
| collection                           | Collection UUID or collection name   |
+————————————–+————————————–+
| entity                               | Entity UUID or entity name           |
+————————————–+————————————–+
| property                             | An entity property to be updated,    |
|                                      | formatted as a key-value pair. For   |
|                                      | example:                             |
|                                      |                                      |
|                                      |     {"property<em>1":"value</em>1", "proper |
|                                      | ty<em>2":"value</em>2",…}                 |
+————————————–+————————————–+</p>

<p>This example uses the <a href="/app-services-sdks#ios">Apache Usergrid iOS SDK</a>.</p>

<h3 id="example-requestresponse-1">Example Request/Response</h3>

<h4 id="request-1">Request:</h4>

<pre><code>-(NSString*)updateEntity {

    //UUID of the entity to be updated
    NSString *entityID = @"f42752aa-08fe-11e3-8268-5bd5fa5f701f";
    
    //Create an entity object
    NSMutableDictionary *updatedEntity = [[NSMutableDictionary alloc] init ];
    
    //Set entity properties to be updated
    [updatedEntity setObject:@"item" forKey:@"type"]; //Required - entity type
    [updatedEntity setObject:@"in-stock" forKey:@"availability"];
    [updatedEntity setObject:@"4.00" forKey:@"price"];

    //we recommend you call ApigeeClient from your AppDelegate. 
    //for more information see the iOS SDK install guide: http://apigee.com/docs/app-services/content/installing-apigee-sdk-ios
    //create an instance of AppDelegate
    AppDelegate *appDelegate = (AppDelegate *)[[UIApplication sharedApplication] delegate];
    
    //call createEntity to initiate the API call
    ApigeeClientResponse *response = [appDelegate.dataClient updateEntity:entityID entity:updatedEntity];

    @try {
        
       //success
        
    }
    @catch (NSException * e) {
        //fail
    }
    
}
</code></pre>

<h4 id="response-1">Response:</h4>

<pre><code>{
  "action" : "put",
  "application" : "f34f4222-a166-11e2-a7f7-02e81adcf3d0",
  "params" : { },
  "path" : "/items",
  "uri" : "http://api.usergrid.com/your-org/your-app/items",
  "entities" : [ {
    "uuid" : "5bb76bca-1657-11e3-903f-9ff6c621a7a4",
    "type" : "item",
    "name" : "milk",
    "created" : 1378405020796,
    "modified" : 1378505705077,
    "availability" : "in-stock",
    "metadata" : {
      "path" : "/items/5bb76bca-1657-11e3-903f-9ff6c621a7a4"
    },
    "name" : "milk",
    "price" : "4.00"
  } ],
  "timestamp" : 1378505705050,
  "duration" : 87,
  "organization" : "your-org",
  "applicationName" : "your-app"
}
</code></pre>

<h3 id="sdk-method">SDK Method</h3>

<pre><code>(ApigeeClientResponse *)updateEntity: (NSString *)entityID entity:(NSDictionary *)updatedEntity
</code></pre>

<h3 id="parameters-1">Parameters</h3>

<p>Parameter       Description
  ————— ————————————————————-
  entityID        UUID of the entity to be updated
  updatedEntity   NSMutableDictionary containing the properties to be updated</p>

<p>This example uses the <a href="/app-services-sdks#android">Apache Usergrid Android
SDK</a>.</p>

<h3 id="example-requestresponse-2">Example Request/Response</h3>

<h4 id="request-2">Request:</h4>

<pre><code>//Create client entity
String ORGNAME = "your-org";
String APPNAME = "your-app";        
ApigeeClient apigeeClient = new ApigeeClient(ORGNAME,APPNAME);
DataClient dataClient = apigeeClient.getDataClient();

//Create properties object

String entityID = "fd0def5a-091c-11e3-a60d-eb644ab154cc";

Map&lt;String, Object&gt; updatedProperties = new HashMap&lt;String, Object&gt;();
updatedProperties.put("type", "item"); //Required
updatedProperties.put("availability", "in-stock");
updatedProperties.put("price", "4.00");

//call updateEntityAsync to initiate the asynchronous API call
dataClient.updateEntityAsync(entityID, updatedProperties, new ApiResponseCallback() {   
    
    //If updateEntityAsync fails, catch the error
    @Override
    public void onException(Exception e) { 
        // Error
    }
    
    //If updateEntityAsync is successful, handle the response object
    @Override
    public void onResponse(ApiResponse response) {
        try { 
            if (response != null) {
                // Success
            }
        } catch (Exception e) { //The API request returned an error
                // Fail
        }
    }
});
</code></pre>

<h4 id="response-2">Response:</h4>

<pre><code>{"action":"put","application":"f34f4222-a166-11e2-a7f7-02e81adcf3d0","entities":[{"dataClient":{"accessToken":null,"apiUrl":"https://api.usergrid.com","applicationId":"your-app","clientId":null,"clientSecret":null,"currentOrganization":null,"loggedInUser":null,"organizationId":"your-org"},"type":"item","uuid":"5bb76bca-1657-11e3-903f-9ff6c621a7a4","price":"4.00","created":1378405020796,"name":"milk","modified":1378748497900,"availability":"in-stock","metadata":{"path":"/items/5bb76bca-1657-11e3-903f-9ff6c621a7a4"}}],"params":{},"path":"/items","rawResponse":"{
  "action" : "put",
  "application" : "f34f4222-a166-11e2-a7f7-02e81adcf3d0",
  "params" : { },
  "path" : "/items",
  "uri" : "http://api.usergrid.com/your-org/your-app/items",
  "entities" : [ {
    "uuid" : "5bb76bca-1657-11e3-903f-9ff6c621a7a4",
    "type" : "item",
    "name" : "milk",
    "created" : 1378405020796,
    "modified" : 1378748497900,
    "availability" : "in-stock",
    "metadata" : {
      "path" : "/items/5bb76bca-1657-11e3-903f-9ff6c621a7a4"
    },
    "name" : "milk",
    "price" : "4.00"
  } ],
  "timestamp" : 1378748497887,
  "duration" : 80,
  "organization" : "your-org",
  "applicationName" : "your-app"
}
","uri":"http://api.usergrid.com/your-org/your-app/items","timestamp":1378748497887,"entityCount":1,"firstEntity":{"dataClient":{"accessToken":null,"apiUrl":"https://api.usergrid.com","applicationId":"your-app","clientId":null,"clientSecret":null,"currentOrganization":null,"loggedInUser":null,"organizationId":"your-org"},"type":"item","uuid":"5bb76bca-1657-11e3-903f-9ff6c621a7a4","price":"4.00","created":1378405020796,"name":"milk","modified":1378748497900,"availability":"in-stock","metadata":{"path":"/items/5bb76bca-1657-11e3-903f-9ff6c621a7a4"}},"lastEntity":{"dataClient":{"accessToken":null,"apiUrl":"https://api.usergrid.com","applicationId":"your-app","clientId":null,"clientSecret":null,"currentOrganization":null,"loggedInUser":null,"organizationId":"your-org"},"type":"item","uuid":"5bb76bca-1657-11e3-903f-9ff6c621a7a4","price":"4.00","created":1378405020796,"name":"milk","modified":1378748497900,"availability":"in-stock","metadata":{"path":"/items/5bb76bca-1657-11e3-903f-9ff6c621a7a4"}},"organization":"your-org","duration":80,"applicationName":"your-app"}                
</code></pre>

<h3 id="sdk-method-1">SDK Method</h3>

<p>Asynchronous:</p>

<pre><code>updateEntityAsync(String entityID, Map&lt;String, Object&gt; updatedProperties, ApiResponseCallback callback)
</code></pre>

<p>Synchronous:</p>

<pre><code>updateEntity(String entityID, Map&lt;String, Object&gt; updatedProperties)
</code></pre>

<h3 id="parameters-2">Parameters</h3>

<p>Parameter           Description
  ——————- ————————————————————————————
  entityID            UUID of the entity to be updated
  updatedProperties   Map object containing the properties to be updated. A 'type' property is required.
  callback            Callback function (Asynchronous calls only)</p>

<p>This example uses the <a href="/app-services-sdks#javascript">Apache Usergrid JavaScript (HTML5)
SDK</a>.</p>

<h3 id="example-requestresponse-3">Example Request/Response</h3>

<h4 id="request-3">Request:</h4>

<pre><code>//Create the Apache Usergrid client object
var dataClient = new Usergrid.Client({
    org_name:'your-org',
    app_name:'your-app'
});

//Specify the UUID of the entity to be updated
//and the properties to be updated
var properties = {
    client:dataClient, //Required
    data:{'type':'item',
    uuid:'b3aad0a4-f322-11e2-a9c1-999e12039f87', //UUID of the entity to be updated is required
    price:'4.00',
    availability:'in-stock'
    }
};

//Create a new entity object that contains the updated properties
var entity = new Usergrid.Entity(properties);

//Call Entity.save() to initiate the API PUT request
entity.save(function (error,response) {

    if (error) { 
        //error
    } else { 
        //success
    }

});    
</code></pre>

<h4 id="response-3">Response:</h4>

<pre><code>Object {action: "put", application: "f34f4222-a166-11e2-a7f7-02e81adcf3d0", params: Object, path: "/items", uri: "http://api.usergrid.com/your-org/your-app/items"…}
action: "put"
application: "f34f4222-a166-11e2-a7f7-02e8sd83f3d0"
applicationName: "your-app"
duration: 62
entities: Array[1]
0: Object
created: 1374534114329
metadata: Object
modified: 1376693371847
name: "milk"
price: "4.00" //updated
availability: "in-stock" //updated
varieties: Array[3] //This property was already present 
type: "item"
uuid: "b3aad0a4-f322-11e2-a9c1-999e12039f87"
varieties: Array[3]
__proto__: Object
length: 1
__proto__: Array[0]
organization: "your-org"
params: Object
path: "/items"
timestamp: 1376693371836
uri: "http://api.usergrid.com/your-org/your-app/items"              
</code></pre>

<h3 id="sdk-method-2">SDK Method</h3>

<pre><code>Entity.save();
</code></pre>

<p>This example uses the <a href="/app-services-sdks#ruby">Apache Usergrid RubyGem</a>.</p>

<h3 id="example-requestresponse-4">Example Request/Response</h3>

<h4 id="request-4">Request:</h4>

<pre><code>#Create a client object
usergrid_api = 'https://api.usergrid.com'
organization = 'your-org'
application = 'your-app'

client = Usergrid::Application.new "#{usergrid_api}/#{organization}/#{application}"

begin

    # Specify the name or uuid of the collection and entity to be updated
    # and the entity properties to be updated
    entity = client['item']['b3aad0a4-f322-11e2-a9c1-999e12039f87'].entity #entity object
    entity.price = '4.00'
    entity.availability = 'in-stock'
    
    # Call save to initiate the API PUT request
    entity.save

rescue

    #fail

end
</code></pre>

<h4 id="response-4">Response:</h4>

<pre><code>{
  "action" : "put",
  "application" : "f34f4222-a166-11e2-a7f7-02e81adcf3d0",
  "params" : { },
  "path" : "/items",
  "uri" : "http://api.usergrid.com/your-org/your-app/items",
  "entities" : [ {
    "uuid" : "5bb76bca-1657-11e3-903f-9ff6c621a7a4",
    "type" : "item",
    "name" : "milk",
    "created" : 1378405020796,
    "modified" : 1378505705077,
    "availability" : "in-stock",
    "metadata" : {
      "path" : "/items/5bb76bca-1657-11e3-903f-9ff6c621a7a4"
    },
    "name" : "milk",
    "price" : "4.00"
  } ],
  "timestamp" : 1378505705050,
  "duration" : 87,
  "organization" : "your-org",
  "applicationName" : "your-app"
}
</code></pre>

<h3 id="sdk-method-3">SDK Method</h3>

<pre><code>save
</code></pre>

<p>The example assumes use of the <a href="/app-services-sdks#nodejs">Apache Usergrid Node.js
module</a>.</p>

<h3 id="example-requestresponse-5">Example Request/Response</h3>

<h4 id="request-5">Request:</h4>

<pre><code>//Create the Apache Usergrid client object
var dataClient = new Usergrid.client({
    org_name:'your-org',
    app_name:'your-app'
});

//Specify the UUID of the entity to be updated
//and the properties to be updated
var properties = {
    client:dataClient, //Required
    data:{'type':'item',
    uuid:'b3aad0a4-f322-11e2-a9c1-999e12039f87', //UUID of the entity to be updated is required
    price:'4.00',
    availability:'in-stock'
    }
};

//Create a new entity object the contains the updated properties
var entity = new Usergrid.entity(properties);

//Call Entity.save() to initiate the API PUT request
entity.save(function (error,response) {

    if (error) { 
        //error
    } else { 
        //success
    }

});             
</code></pre>

<h3 id="example---response">Example - Response</h3>

<pre><code>{
  "action" : "put",
  "application" : "f34f4222-a166-11e2-a7f7-02e81adcf3d0",
  "params" : { },
  "path" : "/items",
  "uri" : "http://api.usergrid.com/your-org/your-app/items",
  "entities" : [ {
    "uuid" : "b3aad0a4-f322-11e2-a9c1-999e12039f87",
    "type" : "item",
    "name" : "milk",
    "created" : 1374534114329,
    "modified" : 1376695962803,
    "metadata" : {
      "path" : "/items/b3aad0a4-f322-11e2-a9c1-999e12039f87"
    },
    "name" : "milk",
    "price" : "4.00",
    "availability" : "in-stock"
  } ],
  "timestamp" : 1376695962790,
  "duration" : 144,
  "organization" : "your-org",
  "applicationName" : "your-app"
}
</code></pre>

<h3 id="sdk-method-4">SDK Method</h3>

<pre><code>Entity.save();
</code></pre>

<h2 id="updating-a-sub-property">Updating a sub-property</h2>

<p>Data entities may contain sets of sub-properties as nested JSON objects.
Unlike normal entity properties, however, sub-properties cannot be
updated individually. Updating a nested object will cause all
sub-properties within it to be overwritten.</p>

<p>For example, if you have a data entity with the following nested object:</p>

<pre><code>"varieties": [
    {
      "name": "1%",
      "price": "3.25",
      "SKU": "0393847575533445"
    },
    {
      "name": "whole",
      "price": "3.85",
      "SKU": "0393394956788445"
    }
]       
</code></pre>

<p>and you send this update to Apache Usergrid:</p>

<pre><code>"varieties": [
    {
      "name": "2%",
      "price": "3.00",
    },
    {
      "price": "4.00",
    }
]       
</code></pre>

<p>this will be the resulting nested object:</p>

<pre><code>"varieties": [
    {
      "name": "2%",
      "price": "3.00",
    },
    {
      "price": "4.00",
    }
]       
</code></pre>

<ul>
  <li><a href="#curl_update_subproperty">cURL</a></li>
  <li><a href="#ios_update_subproperty">iOS</a></li>
  <li><a href="#android_update_subproperty">Android</a></li>
  <li><a href="#javascript_update_subproperty">JavaScript (HTML5)</a></li>
  <li><a href="#ruby_update_subproperty">Ruby</a></li>
  <li><a href="#nodejs_update_subproperty">Node.js</a></li>
</ul>

<h3 id="example-requestresponse-6">Example Request/Response</h3>

<h4 id="request-6">Request:</h4>

<pre><code>curl -X PUT https://api.usergrid.com/your-org/your-app/items/milk -d '{"varieties":[{"name":"1%","price":"3.25"},{"name":"whole","price":"4.00"}]}'
</code></pre>

<h4 id="response-5">Response:</h4>

<pre><code>{
  "action" : "put",
  "application" : "f34f4222-a166-11e2-a7f7-02e81adcf3d0",
  "params" : { },
  "path" : "/items",
  "uri" : "http://api.usergrid.com/your-org/your-app/items",
  "entities" : [ {
    "uuid" : "5bb76bca-1657-11e3-903f-9ff6c621a7a4",
    "type" : "item",
    "name" : "milk",
    "created" : 1378405020796,
    "modified" : 1378761459069,
    "availability" : "in-stock",
    "metadata" : {
      "path" : "/items/5bb76bca-1657-11e3-903f-9ff6c621a7a4"
    },
    "name" : "milk",
    "uri" : "http://api.usergrid.com/your-org/your-app/items/5bb76bca-1657-11e3-903f-9ff6c621a7a4",
    "varieties" : [ {
      "name" : "1%",
      "price" : "3.25"
    }, {
      "name" : "whole",
      "price" : "4.00"
    } ]
  } ],
  "timestamp" : 1378761459047,
  "duration" : 62,
  "organization" : "your-org",
  "applicationName" : "your-app"
}
</code></pre>

<h3 id="request-syntax-1">Request Syntax</h3>

<pre><code>curl -X PUT https://api.usergrid.com/&lt;org_id&gt;/&lt;app_id&gt;/&lt;collection&gt;/&lt;uuid|name&gt; -d '{&lt;property&gt; : [{&lt;sub_property&gt;}, {&lt;sub_property&gt;}...]}'
</code></pre>

<h3 id="parameters-3">Parameters</h3>

<hr />
<p>Parameter          Description
  —————— ——————————————————————————————–
  org_id            Organization UUID or organization name</p>

<p>app_id            Application UUID or application name</p>

<p>collection         Name of the collection containing the entity to be updated</p>

<table>
  <tbody>
    <tr>
      <td>uuid</td>
      <td>name          UUID or name of the data entity to be updated</td>
    </tr>
  </tbody>
</table>

<p>entity_property   The name of the entity property that contains the nested object to be updated</p>

<p>sub_property      Entity properties of the nested object, as a set of key-value pairs in the format:\
                     <em>{&lt;property_name&gt; : &lt;property_value&gt;, &lt;property_name&gt; : &lt;property_value&gt; …}</em>
  —————————————————————————————————————</p>

<p>This example uses the <a href="/app-services-sdks#ios">Apache Usergrid iOS SDK</a>.</p>

<h3 id="example-requestresponse-7">Example Request/Response</h3>

<h4 id="request-7">Request:</h4>

<pre><code>-(NSString*)updateEntity {

    //UUID of the entity to be updated
    NSString *entityID = @"f42752aa-08fe-11e3-8268-5bd5fa5f701f";
        
    //Define our two sub-properties to include in the update
    NSMutableDictionary *subproperty1 = [[NSMutableDictionary alloc] init];
    NSMutableDictionary *subproperty2 = [[NSMutableDictionary alloc] init];
    [subproperty1 setObject:@"1%" forKey:@"name"];
    [subproperty1 setObject:@"3.25" forKey:@"price"];
    [subproperty2 setObject:@"whole" forKey:@"name"];
    [subproperty2 setObject:@"4.00" forKey:@"price"];
    
    //Put our sub-properties into an NSArray
    NSArray *subproperties = [[NSArray alloc] initWithObjects:props1,props2, nil];

    //Create an NSMutableDictionary to hold our updates
    NSMutableDictionary *updatedEntity = [[NSMutableDictionary alloc] init ];

    //Set the properties to be updated
    [updatedEntity setObject:@"item" forKey:@"type"]; //Required - entity type
    [updatedEntity setObject:props forKey:@"varieties"];
    
    //we recommend you call ApigeeClient from your AppDelegate. 
    //for more information see the iOS SDK install guide: http://apigee.com/docs/app-services/content/installing-apigee-sdk-ios
    //create an instance of AppDelegate
    AppDelegate *appDelegate = (AppDelegate *)[[UIApplication sharedApplication] delegate];
    
    //call createEntity to initiate the API call
    ApigeeClientResponse *response = [appDelegate.dataClient updateEntity:entityID entity:updatedEntity];

    @try {
        
       //success
        
    }
    @catch (NSException * e) {
        //fail
    }
    
}
</code></pre>

<h4 id="response-6">Response:</h4>

<pre><code>{
  "action" : "put",
  "application" : "f34f4222-a166-11e2-a7f7-02e81adcf3d0",
  "params" : { },
  "path" : "/items",
  "uri" : "http://api.usergrid.com/your-org/your-app/items",
  "entities" : [ {
    "uuid" : "5bb76bca-1657-11e3-903f-9ff6c621a7a4",
    "type" : "item",
    "name" : "milk",
    "created" : 1378405020796,
    "modified" : 1378761459069,
    "availability" : "in-stock",
    "metadata" : {
      "path" : "/items/5bb76bca-1657-11e3-903f-9ff6c621a7a4"
    },
    "name" : "milk",
    "uri" : "http://api.usergrid.com/your-org/your-app/items/5bb76bca-1657-11e3-903f-9ff6c621a7a4",
    "varieties" : [ {
      "name" : "1%",
      "price" : "3.25"
    }, {
      "name" : "whole",
      "price" : "4.00"
    } ]
  } ],
  "timestamp" : 1378761459047,
  "duration" : 62,
  "organization" : "your-org",
  "applicationName" : "your-app"
}
</code></pre>

<h3 id="sdk-method-5">SDK Method</h3>

<pre><code>(ApigeeClientResponse *)updateEntity: (NSString *)entityID entity:(NSDictionary *)updatedEntity
</code></pre>

<h3 id="parameters-4">Parameters</h3>

<p>Parameter       Description
  ————— ——————————————————-
  entityID        UUID of the entity to be updated
  updatedEntity   Entity object containing the properties to be updated</p>

<p>This example uses the <a href="/app-services-sdks#android">Apache Usergrid Android
SDK</a>.</p>

<h3 id="example-requestresponse-8">Example Request/Response</h3>

<h4 id="request-8">Request:</h4>

<pre><code>//Create client entity
String ORGNAME = "your-org";
String APPNAME = "your-app";        
ApigeeClient apigeeClient = new ApigeeClient(ORGNAME,APPNAME);
DataClient dataClient = apigeeClient.getDataClient();

//UUID of the entity to be updated
String entityID = "1ceed6ba-1b13-11e3-a7a6-59ffaee069e1";

//The object we will pass to the API
Map&lt;String,Object&gt; entityUpdates = new HashMap&lt;String,Object&gt;();

//The objects we will need to setup the sub-properties
ArrayList&lt;Map&lt;String,Object&gt;&gt; subPropertyArray = new ArrayList&lt;Map&lt;String,Object&gt;&gt;();
Map&lt;String,Object&gt; subProperty1 = new HashMap&lt;String,Object&gt;();
Map&lt;String,Object&gt; subProperty2 = new HashMap&lt;String,Object&gt;();

//First sub-property
subProperty1.put("name", "1%");
subProperty2.put("price", "3.25");

//Second sub-property
subProperty2.put("name", "whole");
subProperty2.put("price", "4.00");

//Add the sub-properties to the List object
subPropertyArray.add(subProperty1);
subPropertyArray.add(subProperty2);

//Now we put it all together
entityUpdates.put("type", "item"); //Required
entityUpdates.put("varieties", subPropertyArray);

        
//call updateEntityAsync to initiate the asynchronous API call
dataClient.updateEntityAsync(entityID, updatedProperties, new ApiResponseCallback() {   
    
    //If updateEntityAsync fails, catch the error
    @Override
    public void onException(Exception e) { 
        // Error
    }
    
    //If updateEntityAsync is successful, handle the response object
    @Override
    public void onResponse(ApiResponse response) {
        try { 
            if (response != null) {
                // Success
            }
        } catch (Exception e) { //The API request returned an error
                // Fail
        }
    }
}); 
</code></pre>

<h4 id="response-7">Response:</h4>

<pre><code>{"action":"put","application":"f34f4222-a166-11e2-a7f7-02e81adcf3d0","entities":[{"dataClient":{"accessToken":null,"apiUrl":"https://api.usergrid.com","applicationId":"your-app","clientId":null,"clientSecret":null,"currentOrganization":null,"loggedInUser":null,"organizationId":"your-org"},"type":"item","uuid":"1ceed6ba-1b13-11e3-a7a6-59ffaee069e1","varieties":[{"name":"1%","price":"3.25"},{"name":"whole","price":"4.00"}],"created":1378925465499,"name":"milk","modified":1378936578609,"metadata":{"path":"/items/1ceed6ba-1b13-11e3-a7a6-59ffaee069e1"}}],"params":{},"path":"/items","rawResponse":"{
  "action" : "put",
  "application" : "f34f4222-a166-11e2-a7f7-02e81adcf3d0",
  "params" : { },
  "path" : "/items",
  "uri" : "http://api.usergrid.com/your-org/your-app/items",
  "entities" : [ {
    "uuid" : "1ceed6ba-1b13-11e3-a7a6-59ffaee069e1",
    "type" : "item",
    "name" : "milk",
    "created" : 1378925465499,
    "modified" : 1378936578609,
    "metadata" : {
      "path" : "/items/1ceed6ba-1b13-11e3-a7a6-59ffaee069e1"
    },
    "name" : "milk",
    "varieties" : [ {
      "name" : "1%",
      "price" : "3.25"
    }, {
      "name" : "whole",
      "price" : "4.00"
    } ]
  } ],
  "timestamp" : 1378936578595,
  "duration" : 75,
  "organization" : "your-org",
  "applicationName" : "your-app"
}
","uri":"http://api.usergrid.com/your-org/your-app/items","timestamp":1378936578595,"entityCount":1,"firstEntity":{"dataClient":{"accessToken":null,"apiUrl":"https://api.usergrid.com","applicationId":"your-app","clientId":null,"clientSecret":null,"currentOrganization":null,"loggedInUser":null,"organizationId":"your-org"},"type":"item","uuid":"1ceed6ba-1b13-11e3-a7a6-59ffaee069e1","varieties":[{"name":"1%","price":"3.25"},{"name":"whole","price":"4.00"}],"created":1378925465499,"name":"milk","modified":1378936578609,"metadata":{"path":"/items/1ceed6ba-1b13-11e3-a7a6-59ffaee069e1"}},"lastEntity":{"dataClient":{"accessToken":null,"apiUrl":"https://api.usergrid.com","applicationId":"your-app","clientId":null,"clientSecret":null,"currentOrganization":null,"loggedInUser":null,"organizationId":"your-org"},"type":"item","uuid":"1ceed6ba-1b13-11e3-a7a6-59ffaee069e1","varieties":[{"name":"1%","price":"3.25"},{"name":"whole","price":"4.00"}],"created":1378925465499,"name":"milk","modified":1378936578609,"metadata":{"path":"/items/1ceed6ba-1b13-11e3-a7a6-59ffaee069e1"}},"organization":"your-org","duration":75,"applicationName":"your-app"}
</code></pre>

<h3 id="sdk-method-6">SDK Method</h3>

<p>Asynchronous:</p>

<pre><code>updateEntityAsync(String entityID, Map&lt;String, Object&gt; updatedProperties, ApiResponseCallback callback)
</code></pre>

<p>Synchronous:</p>

<pre><code>updateEntity(String entityID, Map&lt;String, Object&gt; updatedProperties)
</code></pre>

<h3 id="parameters-5">Parameters</h3>

<p>Parameter           Description
  ——————- ————————————————————————————
  entityID            UUID of the entity to be updated
  updatedProperties   Map object containing the properties to be updated. A 'type' property is required.
  callback            Callback function (Asynchronous calls only)</p>

<p>This example uses the <a href="/app-services-sdks#javascript">Apache Usergrid JavaScript (HTML5)
SDK</a>.</p>

<h3 id="example-requestresponse-9">Example Request/Response</h3>

<h4 id="request-9">Request:</h4>

<pre><code>//Create the Apache Usergrid client object
var dataClient = new Usergrid.Client({
    org_name:'your-org',
    app_name:'your-app'
});

//Specify the UUID of the entity to be updated
//and the properties to be updated
var properties = {
    client:dataClient, //Required
    data:{
        type:'item',
        uuid:'b151ddba-0921-11e3-9f60-2ba945ba461f',
        varieties:[
            {"name":"3%", "price":"3.25", "SKU":"9384752200033"},
            {"name":"whole", "price":"4.00", "SKU":"9384752200033"}
        ]
    }
};

//Create a new entity object that contains the updated properties
var entity = new Usergrid.Entity(properties);

//Call Entity.save() to initiate the API PUT request
entity.save(function (error,response) {

    if (error) { 
        //error
    } else { 
        //success
    }

});    
</code></pre>

<h4 id="response-8">Response:</h4>

<pre><code>Object {action: "put", application: "f34f4222-a166-11e2-a7f7-02e81adcf3d0", params: Object, path: "/items", uri: "http://api.usergrid.com/your-org/your-app/items"…}
action: "put"
application: "f34f4222-a166-11e2-a7f7-02e81adcf3d0"
applicationName: "your-app"
duration: 66
entities: Array[1]
    0: Object
    availability: "in-stock"
    created: 1378405020796
    metadata: Object
    modified: 1378760239203
    name: "milk"
    price: "4.00"
    type: "item"
    uri: "http://api.usergrid.com/your-org/your-app/items/5bb76bca-1657-11e3-903f-9ff6c621a7a4"
    uuid: "5bb76bca-1657-11e3-903f-9ff6c621a7a4"
    varieties: Array[2]
        0: Object
            SKU: "9384752200033"
            name: "3%"
            price: "3.25"
            __proto__: Object
        1: Object
            SKU: "9384752200033"
            name: "whole"
            price: "4.00"
            __proto__: Object
        length: 2
        __proto__: Array[0]
    __proto__: Object
    length: 1
__proto__: Array[0]
organization: "your-org"
params: Object
path: "/items"
timestamp: 1378760239191
uri: "http://api.usergrid.com/your-org/your-app/items"
__proto__: Object
</code></pre>

<h3 id="sdk-method-7">SDK Method</h3>

<pre><code>Entity.save();
</code></pre>

<p>This example uses the <a href="/app-services-sdks#ruby">Apache Usergrid RubyGem</a>.</p>

<h3 id="example-requestresponse-10">Example Request/Response</h3>

<h4 id="request-10">Request:</h4>

<pre><code>#Create a client object
usergrid_api = 'https://api.usergrid.com'
organization = 'your-org'
application = 'your-app'

client = Usergrid::Application.new "#{usergrid_api}/#{organization}/#{application}"

begin

    # Specify the name or uuid of the collection and entity to be updated
    # and the entity properties to be updated
    entity = client['item']['b3aad0a4-f322-11e2-a9c1-999e12039f87'].entity #entity object
    entity.varieties = [
            {
                "name" =&gt; "1%",
                "price" =&gt; "3.25",
                "sku" =&gt; "0393847575533445"
            },{
                "name" =&gt; "whole",
                "price" =&gt; "3.85",
                "sku" =&gt; "0393394956788445"
            }
        ]
    
    # Call save to initiate the API PUT request
    entity.save

rescue

    #fail

end
</code></pre>

<h4 id="response-9">Response:</h4>

<p>[[nid:11954]</p>

<h3 id="sdk-method-8">SDK Method</h3>

<pre><code>save
</code></pre>

<p>This example uses the <a href="/app-services-sdks#nodejs">Apache Usergrid Node.js
module</a>.</p>

<h3 id="example-requestresponse-11">Example Request/Response</h3>

<h4 id="request-11">Request:</h4>

<pre><code>//Create the Apache Usergrid client object
var dataClient = new Usergrid.client({
    org_name:'your-org',
    app_name:'your-app'
});

//Specify the UUID of the entity to be updated
//and the properties to be updated

var properties = {
    client:dataClient, //Required
    data:{
        type:'item',
        uuid:'b3aad0a4-f322-11e2-a9c1-999e12039f87', //UUID of the entity to be updated is required
        varieties : [
            {
                "name" : "1%",
                "price" : "3.25",
                "sku" : "0393847575533445"
            },{
                "name" : "whole",
                "price" : "3.85",
                "sku" : "0393394956788445"
            },{
                "name" : "skim",
                "price" : "4.00",
                "sku" : "0390299933488445"      
            }
        ]           
    }
};

//Create a new entity object the contains the updated properties
var entity = new Usergrid.entity(properties);

//Call Entity.save() to initiate the API PUT request
entity.save(function (error,response) {

    if (error) { 
        //error
    } else { 
        //success
    }

});             
</code></pre>

<h4 id="response-10">Response:</h4>

<pre><code>{ action: 'put',
  application: 'f34f4222-a166-11e2-a7f7-02e81adcf3d0',
  params: {},
  path: '/items',
  uri: 'http://api.usergrid.com/your-org/your-app/items',
  entities: 
   [ { uuid: 'b3aad0a4-f322-11e2-a9c1-999e12039f87',
       type: 'item',
       created: 1374534114329,
       modified: 1377039726738,
       metadata: [Object],
       varieties: [Object] } ],
  timestamp: 1377039726724,
  duration: 75,
  organization: 'your-org',
  applicationName: 'your-app' }
</code></pre>

<h3 id="sdk-method-9">SDK Method</h3>

<pre><code>Entity.save();
</code></pre>

    </div>
  </div>
</div><footer class="bs-footer" role="contentinfo">
      <div class="container">
        <p class="text-muted">
          环信即时通讯云
        </p>
      </div>
    </footer>
    <script src="http://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>
    <script src="http://cdn.bootcss.com/twitter-bootstrap/3.0.3/js/bootstrap.min.js"></script>
    <script src="http://cdn.bootcss.com/holder/2.0/holder.min.js"></script>
    <script src="http://cdn.bootcss.com/highlight.js/7.3/highlight.min.js"></script>
    <script type="text/javascript">
      hljs.initHighlightingOnLoad();
      var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
      document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F3e5b3453fdcff1e4dec124ea22f1e189' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script src="/assets/js/application.js"></script>
  </body>
</html>